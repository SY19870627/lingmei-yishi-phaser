# 資料結構總覽
以下整理 `src/core/Types.ts` 內使用的資料 Schema，對應到 `/assets/data/*.json`。

## Miasma
| 名稱 | 型別 | 說明 |
| --- | --- | --- |
| `Miasma` | `"清" \| "濁" \| "沸"` | 靈體或場域的煞氣狀態。 |

## SacredItem
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 物品唯一代號。 |
| `名` | `string` | 顯示名稱。 |
| `來源` | `string` | 取得來源或典故。 |
| `用途` | `("安撫"\|"請託"\|"作證"\|"喚醒")[]` | 物品可對應的儀式用途。 |
| `鉤子` | `string?` | 觸發劇情的提示或關聯線索。 |

## WordCard
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 字卡代號。 |
| `字` | `string` | 顯示字詞。 |
| `標籤` | `("安撫"\|"提問"\|"交換"\|"儀式"\|"指認")[]` | 字卡適用的語氣或功能分類。 |
| `備註` | `string?` | 額外說明或使用情境。 |

## Obsession
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 執念代號。 |
| `名` | `string` | 執念敘述。 |
| `條件` | `string[]` | 達成所需條件敘述。 |
| `狀態` | `"未解"\|"鬆動"\|"已解"` | 當前完成度。 |

## Spirit
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 靈體代號。 |
| `名` | `string` | 靈體姓名。 |
| `年代` | `string` | 生前年代背景。 |
| `場域_anchor` | `string` | 所屬錨點 id。 |
| `初始狀態` | `"現身"\|"失我"` | 初次溝通狀態。 |
| `煞氣` | `Miasma` | 靈體煞氣濃度。 |
| `背景` | `string` | 背景故事描述。 |
| `執念` | `Obsession[]` | 需解的執念清單。 |
| `特例` | `{ 類型:"失我靈"\|"拒談靈"; 關鍵物?:string; 關鍵人物?:string; 拒談觸發?:string; }?` | 特殊互動規則。 |
| `限制` | `{ 唯一性鍵:string[]; }?` | 用於資料驗證的唯一鍵。 |

## Anchor
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 場景錨點代號。 |
| `地點` | `string` | 顯示地點名稱。 |
| `條件` | `string[]` | 進入或啟動條件。 |
| `服務靈` | `string` | 對應的靈體 id。 |
| `完成後` | `{ 裝飾?:string; 回聲腳本?:string; }?` | 劇情完成時的場景變化。 |

## NPC
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | NPC 代號。 |
| `稱呼` | `string` | NPC 稱呼。 |
| `性格` | `string[]` | 個性特質。 |
| `避雷` | `string[]` | 禁忌或需避免的話題。 |
| `轉折階段` | `("抗拒"\|"猶豫"\|"願試"\|"承諾")[]` | 調解時的階段流程。 |
| `可被說動的點` | `string[]` | 說服切入點。 |
| `到場條件` | `string[]` | NPC 出現需求。 |

## StoryNode
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `id` | `string` | 劇情節點代號。 |
| `anchor` | `string` | 所屬錨點 id。 |
| `steps` | `StoryStep[]` | 劇情步驟陣列。`StoryStep` 可為 `TEXT`、`GIVE_ITEM`、`UPDATE_FLAG`、`CALL_GHOST_COMM`、`CALL_MEDIATION`、`END` 等指令。 |

## GhostOption
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `text` | `string` | 提示玩家的對話文字。 |
| `type` | `"安撫"\|"提問"\|"交換"\|"儀式"\|"指認"` | 選項對應的字卡類型。 |
| `targets` | `string[]` | 指向的執念或對象 id。 |
| `requires` | `string[]` | 需要持有的物品或旗標。 |
| `effect` | `"解結"\|"鬆動"\|"平煞"\|"條件交換"\|"觸怒"` | 選項影響結果。 |
| `hint` | `string?` | 額外提示。 |

## WorldStateData
| 欄位 | 型別 | 說明 |
| --- | --- | --- |
| `位置` | `string` | 玩家所在位置。 |
| `煞氣` | `Miasma` | 當前場域煞氣。 |
| `陰德` | `"低"\|"中"\|"高"` | 靈媒陰德評級。 |
| `同行` | `string[]` | 同行角色 id。 |
| `物品` | `string[]` | 已持有物品 id。 |
| `字卡` | `string[]` | 已取得字卡 id。 |
| `旗標` | `Record<string, any>` | 任務旗標與提示。 |
| `已安息靈` | `string[]` | 已送行的靈體 id。 |
| `對話摘要` | `string[]` | 已觸發的重要對話紀錄。 |
| `版本` | `number` | 儲存檔案版本，供資料升級用。 |